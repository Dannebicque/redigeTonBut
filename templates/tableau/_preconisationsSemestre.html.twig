<div style="overflow-x: auto">
    <table class="table table-bordered">
        <thead>
        <tr>
            <th>Compétences</th>
            <th>AC</th>
            <th>&nbsp;</th>
            {% for sae in saes %}
                <th><p data-bs-toggle="tooltip" title="{{ sae.libelle }}">{{ sae.codeMatiere }}</p></th>
            {% endfor %}

            <th>&nbsp;</th>
            {% for ressource in ressources %}
                <th><p data-bs-toggle="tooltip" title="{{ ressource.libelle }}">{{ ressource.codeMatiere }}</p></th>
            {% endfor %}
            <th>&nbsp;</th>
            <th>ECTS</th>
            <th>Coefficients / UE</th>
            <th>Rapport coeffs SAÉ / coeffs UE</th>
        </tr>
        </thead>
        <tbody>

        {% for niveau in niveaux %}
            <tr>
                <th class="bg_{{ niveau.competence.couleur }}">
                    {{ niveau.competence.nomCourt }}
                </th>
                <th class="bg_{{ niveau.competence.couleur }}">
                    UE {{ semestre.ordreLmd }}.{{ niveau.competence.numero }}
                </th>
                <th>&nbsp;</th>

                {% for sae in saes %}
                    <td>
                        <input type="text" class="form-control"
                               @keyup="updateSae"
                               data-sae="{{ sae.id }}"
                               data-competence="{{ niveau.competence.id }}"
                               x-bind:value="afficheValeurCoefficient(donnees[{{ semestre.id }}].saes, {{ sae.id }}, {{ niveau.competence.id }})">
                    </td>
                {% endfor %}

                <th>&nbsp;</th>
                {% for ressource in ressources %}
                    <td>
                        <input type="text" class="form-control"
                               @keyup="updateRessource"
                               style="min-width: 50px"
                               data-ressource="{{ ressource.id }}"
                               data-competence="{{ niveau.competence.id }}"
                               x-bind:value="afficheValeurCoefficient(donnees[{{ semestre.id }}].ressources, {{ ressource.id }}, {{ niveau.competence.id }})">
                    </td>
                {% endfor %}
                <td></td>
                <td><input type="text" class="form-control"
                           @keyup="updateCompetence"
                           style="min-width: 50px"
                           data-competence="{{ niveau.competence.id }}"
                           data-semestre="{{ semestre.id }}"
                           x-bind:value="afficheValeurTotal(donnees[{{ semestre.id }}].competences, {{ niveau.competence.id }},
                'ects')"></td>
                <td x-text="afficheValeurTotal(donnees[{{ semestre.id }}].competences, {{ niveau.competence.id }})"
                    class="text-center"
                ></td>
                <td class="text-center"
                    x-text="afficheValeurTotal(donnees[{{ semestre.id }}].competences, {{ niveau.competence.id }},
                'rapport')
"></td>
            </tr>
        {% endfor %}

        <tr>
            <th colspan="2">Poids de chaque SAÉ ou ressource</th>
            <th>&nbsp;</th>
            {% for sae in saes %}
                <td class="text-center"
                    x-text="afficheValeurTotal(donnees[{{ semestre.id }}].saes, {{ sae.id }})">Tot
                </td>
            {% endfor %}

            <th>&nbsp;</th>
            {% for ressource in ressources %}
                <td class="text-center"
                    x-text="afficheValeurTotal(donnees[{{ semestre.id }}].ressources, {{ ressource.id }})">Tot
                </td>
            {% endfor %}
            <td></td>
            <td class="text-center" x-html="badgeEgalite(afficheTotalEcts(donnees[{{ semestre.id }}].semestre,
            'nb_ects'), 30)
"></td>
            <td></td>
            <td></td>
        </tr>
        </tbody>
        <tfoot>
        <tr>
            <th colspan="{{ saes|length + ressources|length + 7 }}"></th>
        </tr>
        <tr>
            <td colspan="2" style="background-color: #7030a0; color: white; font-weight: bold">Volume horaire hors projets</td>
            <th>&nbsp;</th>
            {% for sae in saes %}
                <td class="text-center">
                    <input type="text" class="form-control"
                           @keyup="updateHeuresSae"
                           style="min-width: 50px"
                           data-sae="{{ sae.id }}"
                           data-type="heures_totales"
                           x-bind:value="afficheVolumeHoraire(donnees[{{ semestre.id }}].saes, {{ sae.id
                           }}, 'heures_totales')">
                </td>
            {% endfor %}

            <th>&nbsp;</th>
            {% for ressource in ressources %}
                <td class="text-center">
                    <input type="text" class="form-control"
                           @keyup="updateHeuresRessource"
                           style="min-width: 50px"
                           data-ressource="{{ ressource.id }}"
                           data-type="heures_totales"
                           x-bind:value="afficheVolumeHoraire(donnees[{{ semestre.id }}].ressources, {{ ressource.id
                           }}, 'heures_totales')">
                </td>
            {% endfor %}
            <td></td>
            <td colspan="2" style="background-color: #7030a0; color: white; font-weight: bold">
                Total Volume horaire hors projets</td>
            <td x-text="afficheVolumeHoraireTotal(donnees[{{ semestre.id }}].semestre, 'total_hors_projet')">...</td>
        </tr>
        <tr>
            <td colspan="2" style="background-color: #7030a0; color: white; font-weight: bold">dont hTP</td>
            <th>&nbsp;</th>
            {% for sae in saes %}
                <td class="text-center">
                    <input type="text" class="form-control"
                           @keyup="updateHeuresSae"
                           style="min-width: 50px"
                           data-sae="{{ sae.id }}"
                           data-type="heures_tp"
                           x-bind:value="afficheVolumeHoraire(donnees[{{ semestre.id }}].saes, {{ sae.id
                           }}, 'heures_tp')">
                </td>
            {% endfor %}

            <th>&nbsp;</th>
            {% for ressource in ressources %}
                <td class="text-center">
                    <input type="text" class="form-control"
                           @keyup="updateHeuresRessource"
                           style="min-width: 50px"
                           data-ressource="{{ ressource.id }}"
                           data-type="heures_tp"
                           x-bind:value="afficheVolumeHoraire(donnees[{{ semestre.id }}].ressources, {{ ressource.id
                           }}, 'heures_tp')">
                </td>
            {% endfor %}
            <td></td>
            <td colspan="2" style="background-color: #7030a0; color: white; font-weight: bold">dont hTP</td>
            <td x-text="afficheVolumeHoraireTotal(donnees[{{ semestre.id }}].semestre, 'dont_tp')">...</td>
        </tr>
        <tr>
            <td colspan="2" style="background-color: #7030a0; color: white; font-weight: bold">Heures projets</td>
            <th>&nbsp;</th>
            {% for sae in saes %}
                <td class="text-center">
                    <input type="text" class="form-control"
                           @keyup="updateHeuresSae"
                           style="min-width: 50px"
                           data-sae="{{ sae.id }}"
                           data-type="heures_projet"
                           x-bind:value="afficheVolumeHoraire(donnees[{{ semestre.id }}].saes, {{ sae.id
                           }}, 'heures_projet')">
                </td>
            {% endfor %}

            <th>&nbsp;</th>
            <td colspan="{{ ressources|length + 1 }}"></td>
            <td colspan="2" style="background-color: #7030a0; color: white; font-weight: bold">Total h projet</td>
            <td x-text="afficheVolumeHoraireTotal(donnees[{{ semestre.id }}].semestre, 'total_h_projet')">...</td>
        </tr>
        <tr>
            <th colspan="{{ saes|length + ressources|length + 5 }}"></th>
            <td colspan="2" style="background-color: #7030a0; color: white; font-weight: bold">Total volume horaire dont projets</td>
            <td x-text="afficheVolumeHoraireTotal(donnees[{{ semestre.id }}].semestre, 'total_vol_dont_prj')">...</td>
        </tr>
        <tr>
            <th colspan="{{ saes|length + ressources|length + 5 }}"></th>
            <td colspan="2" style="background-color: #7030a0; color: white; font-weight: bold">Rapport (hTP+heures projets+SAÉ)/total</td>
            <td x-text="numberFormat(afficheVolumeHoraireTotal(donnees[{{ semestre.id }}].semestre, 'rapport'))">..
                                                                                                                 .</td>
        </tr>
        </tfoot>
    </table>
</div>
